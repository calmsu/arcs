<!DOCTYPE html>  <html> <head>   <title>utils.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="app.html">                 app.coffee               </a>                                           <a class="source" href="keyboard.html">                 keyboard.coffee               </a>                                           <a class="source" href="templates.html">                 templates.coffee               </a>                                           <a class="source" href="utils.html">                 utils.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               utils.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Set some properties.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.debug = </span><span class="kc">true</span>
<span class="nv">arcs.version = </span><span class="s2">&quot;v0.1&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Set a baseURL so Backbone.sync works with our dev install.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.baseURL = </span><span class="s1">&#39;/&#39;</span>
<span class="k">if</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">match</span> <span class="sr">/:8080\/~[a-z0-9]+\//</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">baseURL</span> <span class="o">+=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">match</span> <span class="sr">/~[a-z0-9]+\//</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">baseURL</span> <span class="o">+=</span> <span class="s1">&#39;arcs/&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Set or return the hash, and log the change.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.hash = </span><span class="nf">(val=null) -&gt;</span>
    <span class="nv">cur = </span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span>
    <span class="k">if</span> <span class="nx">val</span> <span class="o">==</span> <span class="kc">null</span>
        <span class="k">return</span> <span class="nx">cur</span><span class="p">[</span><span class="mi">1</span><span class="p">..]</span> <span class="o">or</span> <span class="kc">null</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">hashHistory</span><span class="p">.</span><span class="nx">push</span> <span class="nx">cur</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;Setting hash:&#39;</span><span class="p">,</span> <span class="nx">val</span>
    <span class="nb">document</span><span class="p">.</span><span class="nv">location.hash = </span><span class="nx">val</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Store the hash history.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.hashHistory = </span><span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Wraps up modal dialog logic.</p>

<p>The goal here is to avoid dealing with things like opening/closing the modal
and binding click events to buttons in each view. We'll do it all here and 
provide options to customize the functionality.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.modal = </span><span class="nf">(options) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Default options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">defaults =</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Mustache template</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">template: </span><span class="s1">&#39;&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Values to evaluate the template with</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">templateValues: </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Make the modal draggable?</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">draggable: </span><span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Give the modal a backdrop?</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">backdrop: </span><span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Provide an array of input ids and we'll retrieve their values and 
provide them to the callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">inputs: </span><span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Provide an array of button objects. Each key should be the button's 
id. We'll provide any values garnered from the inputs option, along
with the modal dialog element. An example is given below:</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nv">buttons: </span>
            <span class="nv">save:</span>
                <span class="nv">callback: </span><span class="nf">(vals, $modal) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>do something</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">$modal</span><span class="p">.</span><span class="nx">modal</span> <span class="s1">&#39;hide&#39;</span>
                <span class="nv">context: </span><span class="err">@</span>
                <span class="nv">closeAfter: </span><span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Override defaults with givens.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">options = </span><span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Cancel button is free if not defined.
Can't put it in defaults because extend is not recursive.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="o">not</span> <span class="nx">options</span><span class="p">.</span><span class="nx">buttons</span><span class="p">.</span><span class="nx">cancel</span><span class="o">?</span>
        <span class="nv">options.buttons.cancel =</span>
            <span class="nv">closeAfter: </span><span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Check to see if the page already has a modal DOM el.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="o">not</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#modal&#39;</span><span class="p">).</span><span class="nx">length</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">arcs</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">modal_wrapper</span><span class="p">)</span>
    <span class="nv">$modal = </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#modal&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Set the modal</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$modal</span><span class="p">.</span><span class="nx">modal</span>
        <span class="nv">backdrop: </span><span class="nx">options</span><span class="p">.</span><span class="nx">backdrop</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Evaluate and inject the template with any values. </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$modal</span><span class="p">.</span><span class="nx">html</span> <span class="nx">Mustache</span><span class="p">.</span><span class="nx">render</span> <span class="nx">options</span><span class="p">.</span><span class="nx">template</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">templateValues</span>
    <span class="nx">$modal</span><span class="p">.</span><span class="nx">modal</span> <span class="s1">&#39;show&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>If they want it draggable, make it so (with jQuery UI).</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$modal</span><span class="p">.</span><span class="nx">draggable</span><span class="p">()</span> <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">draggable</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Iterate through the buttons and bind them. This is where it gets 
complicated.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="nx">id</span> <span class="k">in</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">buttons</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Use one to avoid double triggers:</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$modal</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;##{id}&quot;</span><span class="p">).</span><span class="nx">one</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Since this is async, we can't rely on the loop iterator inside.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">opts = </span><span class="nx">options</span><span class="p">.</span><span class="nx">buttons</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Get the input vals, if any inputs were given.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">vals = </span><span class="p">{}</span>
            <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">length</span>
                <span class="k">for</span> <span class="nx">id_</span> <span class="k">in</span> <span class="nx">options</span><span class="p">.</span><span class="nx">inputs</span>
                    <span class="nx">vals</span><span class="p">[</span><span class="nx">id_</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$modal</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;##{id_}&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Backup values for context &amp; callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">context = </span><span class="nx">opts</span><span class="p">.</span><span class="nx">context</span> <span class="o">?</span> <span class="err">@</span>
            <span class="nv">callback = </span><span class="nx">opts</span><span class="p">.</span><span class="nx">callback</span> <span class="o">?</span> <span class="o">-&gt;</span>
            <span class="nv">closeAfter = </span><span class="nx">opts</span><span class="p">.</span><span class="nx">closeAfter</span> <span class="o">?</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Bind the function to a context, if given.
This allows callbacks to operate in the context of their own 
object. (For example, Search.tagSelected bound to Search)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">callback = </span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Fire the callback with the vals we retrieved and the modal.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">callback</span><span class="p">(</span><span class="nx">vals</span><span class="p">,</span> <span class="nx">$modal</span><span class="p">)</span>

            <span class="k">if</span> <span class="nx">closeAfter</span>
                <span class="nx">$modal</span><span class="p">.</span><span class="nx">modal</span> <span class="s1">&#39;hide&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Return the modal el.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$modal</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Logic to remove and replace input values on focus/blur
Does the same thing as input[placeholder] but will work in older browsers.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.focusHelper = </span><span class="nf">($input) -&gt;</span>
    <span class="nv">original = </span><span class="nx">$input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span>
    <span class="nx">$input</span><span class="p">.</span><span class="nx">live</span> <span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
        <span class="k">if</span> <span class="nx">$input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">==</span> <span class="nx">original</span>
            <span class="nx">$input</span><span class="p">.</span><span class="nx">val</span> <span class="s1">&#39;&#39;</span>
            <span class="nx">$input</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s1">&#39;unfocused&#39;</span>
    <span class="nx">$input</span><span class="p">.</span><span class="nx">live</span> <span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
        <span class="k">if</span> <span class="nx">$input</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
            <span class="nx">$input</span><span class="p">.</span><span class="nx">val</span> <span class="nx">original</span>
            <span class="nx">$input</span><span class="p">.</span><span class="nx">addClass</span> <span class="s1">&#39;unfocused&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Logs messages with an ARCS prefix if debug is on and a console is 
available (there's no console in older IE's).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.log = </span><span class="nf">(msg...) -&gt;</span>
    <span class="k">if</span> <span class="nx">arcs</span><span class="p">.</span><span class="nx">debug</span> <span class="o">and</span> <span class="nx">console</span><span class="o">?</span><span class="p">.</span><span class="nx">log</span><span class="o">?</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;[ARCS]:&#39;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">...</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Inject some logging into Backbone.sync</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">_sync = </span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span>
<span class="nv">Backbone.sync = </span><span class="nf">(method, model, options) -&gt;</span>
    <span class="nx">arcs</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;Backbone.sync:&#39;</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span>
    <span class="nx">_sync</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Console startup message.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.startup = </span><span class="o">-&gt;</span>
    <span class="nv">debug = </span><span class="k">if</span> <span class="nx">arcs</span><span class="p">.</span><span class="nx">debug</span> <span class="k">then</span> <span class="s2">&quot;on&quot;</span> <span class="k">else</span> <span class="s2">&quot;off&quot;</span>
    <span class="nv">debug_opp = </span><span class="k">if</span> <span class="nx">arcs</span><span class="p">.</span><span class="nx">debug</span> <span class="k">then</span> <span class="s2">&quot;off&quot;</span> <span class="k">else</span> <span class="s2">&quot;on&quot;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;********************************************************&quot;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;[ARCS #{arcs.version}]: Debug is #{debug}.\n&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;To turn it #{debug_opp}, set `arcs.debug` to #{not arcs.debug}.&quot;</span> 
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;********************************************************&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Run the startup message on script load.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arcs</span><span class="p">.</span><span class="nx">startup</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Return information about mime types</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">arcs.mime = </span><span class="nf">(mime) -&gt;</span>
    <span class="nv">images = </span>
        <span class="s1">&#39;image/png&#39;</span><span class="o">:</span> <span class="s1">&#39;png&#39;</span>
        <span class="s1">&#39;image/jpeg&#39;</span><span class="o">:</span> <span class="s1">&#39;jpeg&#39;</span>
        <span class="s1">&#39;image/jpg&#39;</span><span class="o">:</span> <span class="s1">&#39;jpg&#39;</span>
        <span class="s1">&#39;image/gif&#39;</span><span class="o">:</span> <span class="s1">&#39;gif&#39;</span>

    <span class="nv">documents = </span>
        <span class="s1">&#39;application/pdf&#39;</span><span class="o">:</span> <span class="s1">&#39;pdf&#39;</span>
        <span class="s1">&#39;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#39;</span><span class="o">:</span> <span class="s1">&#39;docx&#39;</span>
        <span class="s1">&#39;application/msword&#39;</span><span class="o">:</span> <span class="s1">&#39;doc&#39;</span>
        <span class="s1">&#39;text/plain&#39;</span><span class="o">:</span> <span class="s1">&#39;plaintext&#39;</span>
        <span class="s1">&#39;text/richtext&#39;</span><span class="o">:</span> <span class="s1">&#39;richtext&#39;</span>
        <span class="s1">&#39;text/rtf&#39;</span><span class="o">:</span> <span class="s1">&#39;rtf&#39;</span>

    <span class="nv">videos = </span>
        <span class="s1">&#39;video/mpeg&#39;</span><span class="o">:</span> <span class="s1">&#39;mpeg&#39;</span>
        <span class="s1">&#39;video/msvideo&#39;</span><span class="o">:</span> <span class="s1">&#39;avi&#39;</span>
        <span class="s1">&#39;video/quicktime&#39;</span><span class="o">:</span> <span class="s1">&#39;mov&#39;</span>

    <span class="nv">types =</span>
        <span class="nv">image: </span><span class="nx">images</span>
        <span class="nb">document</span><span class="o">:</span> <span class="nx">documents</span>
        <span class="nv">video: </span><span class="nx">videos</span>

    <span class="nv">undef = </span>
        <span class="nv">type: </span><span class="s1">&#39;undefined&#39;</span>
        <span class="nv">ext: </span><span class="kc">null</span>

    <span class="k">for</span> <span class="nx">type</span> <span class="k">in</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">types</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">mime</span> <span class="k">in</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">type</span><span class="p">])</span>
            <span class="nv">result = </span>
                <span class="nv">type: </span><span class="nx">type</span>
                <span class="nv">ext: </span><span class="nx">types</span><span class="p">[</span><span class="nx">type</span><span class="p">][</span><span class="nx">mime</span><span class="p">]</span>

    <span class="nx">result</span> <span class="o">or</span> <span class="nx">undef</span> 

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 